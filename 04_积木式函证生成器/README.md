询证函是审计工作中少有的直接取得第三方证据的审计手段。基本上十个证监会的处罚有八个会提到询证函的工作没有做到位。往往我们执行函证这个程序的对象一般有银行，客户或供应商等往来单位，被审计单位的高管与员工，律师，海关等。函证内容和形式也会根据审计证据的需要包罗万象，形态万千。

询证函的制作，其实只不过是将询证函的内容从排版合理的函证统计表中，批量填写到对应询证函模板的指定位置上。所以最简单的函证制作，往往通过WORD的邮件合并功能就可以完成。但是邮件合并通常无法将多行的数据批量填写到一个模板中，遇到这种机械重复的复制粘贴的工作，EXCEL VBA就能替我们完成它。

本章节我们将为大家提供一款适用于各行各业，可以自由插行插列函证无数个事项与内容的函证模板。由于这款询证函模板的VBA代码可以说是最基础经典的VBA运用，所以本书会在这章节针对VBA代码的基础知识和内容编写进行展开，让大家可以对VBA有个简单的了解。
# 示例：函证模板的使用                                                      
函证模板的修改与制作

## 步骤1：
点击“显示函证模板”选项，修改、制作合适的询证函模板。

![](https://github.com/nigo81/tools-for-auditor/blob/master/04_积木式函证生成器/photo/1.jpg)

## 步骤2：
修改模板时需要特别注意各个函证事项填写的起始行数（如图所示：往来款项从第16行开始填写，交易额事项从第21行开始填写），模板的截止列（如图所示函证模板的打印范围的最后一列E列），索引号填写的单元格（如图所示：索引号填写在E3单元格）
 
![](https://github.com/nigo81/tools-for-auditor/blob/master/04_积木式函证生成器/photo/2.jpg)

PS：如果我们不需要修改模板，内置的询证函模板右边的非打印区域记录了这个模板的相关信息与参数，直接将我们需要的信息贴至操作平台即可。
 
![](https://github.com/nigo81/tools-for-auditor/blob/master/04_积木式函证生成器/photo/3.jpg)

## 步骤3：
条形码索引号，被审计单位名称，被函证方名称，银行扣款账号等信息都是通过VLOOKUP函数，或INDEX+MATCH函数，以索引号为匹配字段，单条件匹配从基本信息表获得的。可以自行使用公式对其进行修改，注意检查一下相关公式的准确性。
步骤4：修改好您需要的模板后，将对应的参数，表头，信息贴到操作平台中。操作平台终止列，再贴完数据后查看工作表上方的对应列即可，数据模板终止列由于需要添加一列索引号作为匹配字段，永远比询证函模板多一列（如图所示:函证模板为E列，数据模板多一列即为F列）。点击隐藏函证模板，会将模板池中我们不需要的函证模板全部隐藏。
 
![](https://github.com/nigo81/tools-for-auditor/blob/master/04_积木式函证生成器/photo/4.jpg)

# 函证数据的收集与整理

## 步骤1：
点击“操作平台表”下的生成数据表，会按照你填写的数据表名称及相关信息生成一个用于统计相关数据的表格。
 
![](https://github.com/nigo81/tools-for-auditor/blob/master/04_积木式函证生成器/photo/5.jpg)

## 步骤2：
在“基本信息”与对应数据表里，填写相应的函证信息与数据。
 
![](https://github.com/nigo81/tools-for-auditor/blob/master/04_积木式函证生成器/photo/6.jpg)

基本信息表填写时，注意索引号必须唯一，数据表格的数据是按照索引号进行匹配的。
 
![](https://github.com/nigo81/tools-for-auditor/blob/master/04_积木式函证生成器/photo/7.jpg)

数据表填写时注意索引号需要降序排列，保证同一个索引号的信息放在一起。在数据统计表终止列外可以随意加列或加信息，这些信息只是便于统计或识别，不参与函证的生成。

# 函证的生成与打印

## 步骤1：
完成数据填写的工作后，返回“操作平台”点击“生成询证函”按钮，就会生成按基本信息表中函证序号命名的询证函。
 
![](https://github.com/nigo81/tools-for-auditor/blob/master/04_积木式函证生成器/photo/8.jpg)

## 步骤2：
基本信息工作表中有链接方便跳转至对应询证函，对生成的函证进行检查。
 
![](https://github.com/nigo81/tools-for-auditor/blob/master/04_积木式函证生成器/photo/9.jpg)
 
![](https://github.com/nigo81/tools-for-auditor/blob/master/04_积木式函证生成器/photo/10.jpg)

## 步骤3：
确定生成的询证函信息无误后，点击操作平台里的生成PDF函证，可以将选中指定序号区间的询证函制作成PDF，发送给企业打印，以保证条形码索引号打印时完好。
 
