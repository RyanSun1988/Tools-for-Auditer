# 银行流水核对工具（多帐户版）

作  者 | 王文铖

公众号 | 15Seconds


银行流水动辄上千上万条的数据给核对人员，不论是审计实习生，还是企业财务人员，都会带来了不小的压力。银行流水核对工作谈不上有什么难度，只是需要不断重复进行双向核对，可能比较枯燥。

但是对于这种重复枯燥的工作，EXCEL VBA却可以轻松胜任，尤其是面对多账户且数据量大的核对情景时。

本文的工具是在 银行流水核对工具-v5（微信公众号：逆行的狗）的代码基础做出部分修改，主要是添加了同时核对多个银行账户的功能，下面会简单介绍一下工具的使用方法（其实只需要单击三个按钮就可以）。

一、导入数据

按照示例模板把多个账户的序时账和银行流水整理好复制到对应表格，为方便测试和保密，工具中我也提供了模拟的多账户数据。

数据格式要求（这一步完成了就算是完成了一大半了）：

1、序时账和流水的第一列账户必填，没有的话可以用“账户1、账户2、账户3”代替

2、第一列账户必须连续，不能交叉出现，不能为空，且账户名称不能超过26个字符，可用Len()函数检验

3、序时账和流水的时间和借贷方金额必填，对方户名可不填

4、时间必须为日期格式（yyyy-m-d 或者 yyyy/m/d），可用Month()函数检验

5、借贷方金额中必须为数值，不能出现特殊字符，要注意减号的区分，千分隔符下的0会显示为“-”，这也算是数值格式，而减号不是数值格式

6、跨期时间要在1-31天之内

二、格式校验

单击“格式校验”按钮，如果提示哪里有格式错误，修正后重新进行格式校验，直至提示没有问题之后，才可开始进行核对工作。

三、流水核对

单击“流水核对”按钮，核对方式有四种（方式1：日期+对方+金额  方式2：日期+金额  方式3：月份合计  方式4：手工调整），方式1和方式2的符号是“✔”，方式3的符号是“-”，方式4后续再说明，单击符号“✔”单元格会显示一个数字，这个数字就是相匹配的对应行所在行号。

四、展示结果

单击“暂时(刷新)结果”按钮，会对第三步的结果生成更为详细的分月份展示的报表，每个账户对应一个报表



本公众号工具会在Github上正式发布和后续更新。

Github项目地址：https://github.com/nigo81/tools-for-auditor

微信公众号：15Seconds
